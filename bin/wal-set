#!/usr/bin/env bash
#
# Script to set colors generated by 'wal'
# https://github.com/dylanaraps/wal

# Source generated colors.
source "${HOME}/.cache/wal/colors.sh"

reload_dunst() {
    pkill dunst && \
        dunst \
            -lb "$color15" \
            -nb "$color15" \
            -cb "$color15" \
            -lf "$color0"  \
            -bf "$color0"  \
            -cf "$color9" &
}

set_bar() {
    pkill bar
    bar "$color15" "$color0" 2>/dev/null &
}

set_scss() {
    sassc --style expanded "${HOME}/projects/startpage/scss/style.scss" > "${HOME}/projects/startpage/style.css"
}

set_polybar() {
	polydir="$HOME/.config/polybar"
	walcache="$HOME/.cache/wal"
	pconf="$polydir/config"
	cat $polydir/header > $pconf
	echo "[walcolors]" >> $pconf
	cat $walcache/colors.sh|sed "s/=/ = /g"|sed "s/'//g" >> $pconf
	echo "" >> $pconf
	cat $polydir/template >> $pconf

}

set_i3() {
	i3dir="$HOME/.config/i3"
	i3conf="$i3dir/config"
	i3tmpl="$i3dir/templates"
	cat $i3tmpl/template-top > $i3conf
	echo "client.focused          $color9 $color9 $color9 $color9 $color9" >> $i3conf
	echo "client.focused_inactive $color2 $color2 $color2 $color2 $color2" >> $i3conf
	echo "client.unfocused        $color2 $color2 $color2 $color2 $color2" >> $i3conf
	echo "client.urgent           $color2 $color2 $color2 $color2 $color2" >> $i3conf
	echo "client.placeholder      $color2 $color2 $color2 $color2 $color2" >> $i3conf
	cat $i3tmpl/template-bottom >> $i3conf
}

main() {
    reload_dunst &
    set_bar &
    set_scss &
	set_polybar &
	set_i3 &
}

main >/dev/null 2>&1
